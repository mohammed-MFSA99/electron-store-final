{% extends 'base.html' %} {% load static %} {% load i18n %} {% block content %}

<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>ØªÙØ§ØµÙŠÙ„|Ø§Ù„Ù…Ù†ØªØ¬</title>

    <style>
      :root {
        --clr-primary: #f25715;
        --clr-primary-contrast: #ffffff;
        --clr-primary-hover: #e85c31;
        --clr-primary-muted: #ffe2d4;
        --clr-ink: #2f3a45;
        --clr-ink-muted: #66727e;
        --clr-bg: #fbf8f3;
        --clr-surface: #ffffff;
        --clr-muted-bg: #fbf8f3;
        --clr-section-peach: #fbe8da;
        --clr-border: #e6e8ef;
        --clr-footer-bg: #0f1e2e;
        --clr-footer-text: #e6e9ee;
      }

      /* Ø¥Ø¶Ø§ÙØ§Øª Ø®Ø§ØµØ© Ø¨ØµÙØ­Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ */
      .product-detail-section {
        padding: 40px 0 80px;
        background-color: var(--clr-bg);
      }

      .product-gallery {
        display: flex;
        flex-direction: row-reverse;
        gap: 24px;
        align-items: flex-start;
        position: relative;
      }

      .main-image {
        width: 100%;
        height: 500px;
        object-fit: contain;
        background: var(--clr-muted-bg);
        border-radius: var(--radius-card);
        padding: 5px;
        margin-bottom: 20px;
        /* border: 2px solid var(--clr-border); */
        flex: 1;
      }

      .thumbnail-gallery {
        display: flex;
        flex-direction: column;
        gap: 16px;
        align-items: center;
        justify-content: flex-start;
        min-width: 90px;
        max-height: 420px;
        overflow: hidden;
      }

      .thumbnail {
        width: 90px;
        height: 90px;
        object-fit: contain;
        background: var(--clr-muted-bg);
        border-radius: 15px;
        padding: 5px;
        /* border: 2px solid transparent; */
        cursor: pointer;
        transition: all 0.3s ease;
      }

      /* carousel controls */
      .thumbnail-carousel {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }
      .thumb-nav {
        background: transparent;
        border: none;
        font-size: 28px;
        color: var(--clr-ink);
        cursor: pointer;
        padding: 6px 8px;
      }
      .thumb-nav:hover {
        color: var(--clr-primary);
      }

      .thumbnail:hover,
      .thumbnail.active {
        border-color: var(--clr-primary);
      }

      .product-info {
        padding-right: 30px;
      }

      .product-title {
        font-size: 20px;
        font-weight: 700;
        color: var(--clr-ink);
        margin-bottom: 15px;
      }

      .product-price {
        font-size: 2rem;
        font-weight: 700;
        color: var(--clr-primary);
        margin-bottom: 20px;
      }

      .product-rating {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
      }

      .rating-stars {
        color: #f39c12;
        font-size: 1.2rem;
      }

      .rating-text {
        color: var(--clr-ink-muted);
        font-size: 1rem;
      }

      .product-description {
        font-size: 1.1rem;
        line-height: 1.8;
        color: var(--clr-ink);
        margin-bottom: 30px;
      }

      .product-features {
        background: #fccab6;
        padding: 25px;
        border-radius: var(--radius-card);
        margin-bottom: 30px;
        width: 80%;
      }

      .feature-item {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
        font-size: 1rem;
      }

      .feature-item:last-child {
        margin-bottom: 0;
      }

      .feature-item i {
        color: var(--clr-primary);
        margin-left: 10px;
        width: 20px;
      }

      .quantity-selector {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 30px;
      }

      .quantity-label {
        font-weight: 600;
        color: var(--clr-ink);
      }

      .quantity-controls {
        display: flex;
        align-items: center;
        border: 2px solid var(--clr-border);
        border-radius: var(--radius-btn);
        overflow: hidden;
      }

      .quantity-btn {
        background: var(--clr-surface);
        border: none;
        padding: 10px 15px;
        color: var(--clr-ink);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .quantity-btn:hover {
        background: var(--clr-primary);
        color: var(--clr-primary-contrast);
      }

      .quantity-input {
        border: none;
        padding: 10px 15px;
        text-align: center;
        width: 60px;
        background: var(--clr-surface);
        color: var(--clr-ink);
      }

      .action-buttons {
        display: flex;
        gap: 15px;
        margin-bottom: 30px;
      }

      .btn-add-cart {
        background: var(--clr-primary);
        color: var(--clr-primary-contrast);
        border: none;
        padding: 15px 30px;
        border-radius: var(--radius-btn);
        font-weight: 600;
        font-size: 1.1rem;
        transition: all 0.3s ease;
        flex: 1;
      }

      .btn-add-cart:hover {
        background: #ce5029;
        transform: translateY(-1px);
        box-shadow: 4px 5px 10px rgba(255, 106, 61, 0.3);
      }

      .btn-wishlist {
        background: transparent;
        color: var(--clr-ink);
        border: 2px solid var(--clr-border);
        padding: 15px 20px;
        border-radius: var(--radius-btn);
        font-size: 1.2rem;
        transition: all 0.3s ease;
      }

      .btn-wishlist:hover {
        border-color: var(--clr-primary);
        color: var(--clr-primary);
      }

      .product-meta {
        border-top: 1px solid var(--clr-border);
        padding-top: 20px;
      }

      .meta-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
        font-size: 0.95rem;
      }

      .meta-label {
        color: var(--clr-ink-muted);
      }

      .meta-value {
        color: var(--clr-ink);
        font-weight: 500;
      }

      .product-tabs {
        margin-top: 80px;
      }

      .nav-tabs {
        border-bottom: 2px solid var(--clr-border);
      }

      .nav-tabs .nav-link {
        border: none;
        color: var(--clr-ink-muted);
        font-weight: 600;
        padding: 15px 25px;
        border-bottom: 3px solid transparent;
        transition: all 0.3s ease;
      }

      .nav-tabs .nav-link.active {
        color: var(--clr-primary);
        border-bottom-color: var(--clr-primary);
        background: transparent;
      }

      .tab-content {
        padding: 30px 0;
      }

      .specifications-table {
        width: 100%;
        border-collapse: collapse;
      }

      .specifications-table th,
      .specifications-table td {
        padding: 15px;
        text-align: right;
        border-bottom: 1px solid var(--clr-border);
      }

      .specifications-table th {
        background: var(--clr-muted-bg);
        font-weight: 600;
        color: var(--clr-ink);
        width: 30%;
      }

      .specifications-table td {
        color: var(--clr-ink-muted);
      }

      .related-products {
        padding: 80px 0;
        background: var(--clr-bg);
      }

      @media (max-width: 991px) {
        .product-info {
          padding-right: 0;
          margin-top: 30px;
        }

        .product-title {
          font-size: 2rem;
        }

        .action-buttons {
          flex-direction: column;
        }
      }

      @media (max-width: 575.98px) {
        .product-gallery {
          flex-direction: column;
          gap: 12px;
        }

        .product-info {
          padding: 0px 5px;
        }
        .thumbnail-gallery {
          flex-direction: row;
          justify-content: flex-start;
          align-items: center;
          overflow-x: auto;
          gap: 10px;
          min-width: 0;
          margin-bottom: 8px;
        }
        .thumbnail {
          width: 48px;
          height: 48px;
          padding: 3px;
        }
        .main-image {
          height: 220px;
          margin-bottom: 0;
        }
      }

      :root {
        --bg-cream: #fbf7f2; /* Ø®Ù„ÙÙŠØ© ÙƒØ±ÙŠÙ…ÙŠØ© */
        --accent: #f25715; /* Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ù„Ù„Ø£Ø²Ø±Ø§Ø± */
        --muted: #6b6b6b; /* Ù†Øµ Ø«Ø§Ù†ÙˆÙŠ */
        --card-bg: #fff; /* Ø®Ù„ÙÙŠØ© Ø¨Ø·Ø§Ù‚Ø§Øª Ø¯Ø§Ø®Ù„ÙŠØ© */
      }
      /* Top pills (tabs) */
      .tabs-pill {
        display: inline-flex;
        background: transparent;
        padding: 6px;
        border-radius: 999px;
        box-shadow: none;
      }
      .tabs-pill .nav-item + .nav-item {
        margin-right: -35px;
      }
      .tabs-pill .nav-link {
        position: relative;
        z-index: 1;
        border-radius: 30px;
        padding: 13px 90px;
        background: white;
        color: #5d5d5d;
        border: none;
        box-shadow: 5px 4px 8px rgba(0, 0, 0, 0.1);
        font-weight: 600;
        transition: all 0.2s ease-in-out;
      }
      .tabs-pill .nav-link.active {
        z-index: 2;
        background: var(--accent);
        color: #fff;
        box-shadow: 0 8px 20px rgba(255, 106, 42, 0.25);
      }
      /* Review form styles */
      .review-actions {
        display: flex;
        gap: 12px;
        align-items: center;
        margin-bottom: 18px;
      }
      .review-btn {
        background: var(--accent);
        color: #fff;
        border: none;
        padding: 12px 25px;
        border-radius: 25px;
        cursor: pointer;
        font-weight: 600;
      }
      .review-form {
        display: none;
        background: var(--card-bg);
        border: 1px solid var(--clr-border);
        padding: 16px;
        border-radius: 10px;
        box-shadow: 0 6px 18px rgba(15, 35, 61, 0.06);
        margin-bottom: 20px;
      }
      .review-form .form-row {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
      }
      .review-form input[type="text"],
      .review-form textarea,
      .review-form select {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid var(--clr-border);
        border-radius: 6px;
        font-size: 0.95rem;
      }
      .review-form textarea {
        min-height: 100px;
        resize: vertical;
      }
      .review-form .submit-btn {
        background: var(--clr-primary);
        color: var(--clr-primary-contrast);
        border: none;
        padding: 10px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
      }

      /* ØªØµØºÙŠØ± Ø­Ø¬Ù… Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙÙ‚ÙŠ */
      @media (max-width: 575.98px) {
        .tabs-pill {
          display: inline-flex;
          width: 70%;
          padding: 2px;
          gap: 15px;
        }
        .tabs-pill .nav-link {
          padding: 7px 20px;
          font-size: 10px;
          min-width: 70px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Ù…Ø³Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ -->
    {% include "partials/navigation_route.html" with breadcrumbs=breadcrumbs %}

    <!-- Ù‚Ø³Ù… ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ -->
    <section class="product-detail-section">
      <div class="container">
        <div class="row">
          <!-- Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ -->
          <div class="col-lg-6">
            <div class="product-gallery">
             <!-- ğŸ‘‡ Ø§Ø³ØªØ¨Ø¯Ù„ ÙƒÙˆØ¯ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ù„ÙˆÙƒ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ğŸ‘‡ -->
              {% if product.image %}
              <img
                id="mainImage"
                src="{{ product.image.url }}"
                alt="{{ product.name }}"
                class="main-image"
              />
              {% else %}
              <img
                id="mainImage"
                src="https://via.placeholder.com/500x500?text=No+Image"
                alt="{{ product.name }}"
                class="main-image"
                style="background-color: #f0f0f0;"
              />
              {% endif %}
              <!-- ğŸ‘† Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ğŸ‘† -->
              <div class="thumbnail-carousel">
                <div class="thumbnail-gallery">
                  <!-- Ø­Ù„Ù‚Ø© Ù„Ø¹Ø±Ø¶ ÙƒÙ„ ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬ -->
                  {% for p_image in product.images.all %}
                  <img
                    src="{{ p_image.image.url }}"
                    alt="{{ product.title }} - ØµÙˆØ±Ø© Ù…ØµØºØ±Ø©"
                    class="thumbnail {% if forloop.first %}active{% endif %}"
                    onclick="changeMainImage(this)"
                  />
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>

          <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© -->
          <div class="col-lg-6">
            <div class="product-info">
              <h1 class="product-title">{{ product.name }}</h1>
              <!-- ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© -->
              <div class="product-rating">
                {% if review_summary.num_reviews > 0 %}
                <div class="rating-stars">
                  {% with avg_int=review_summary.avg_rating|floatformat:0 %}
                  {%for i in "12345" %} {% if i|add:"0" <= avg_int|add:"0" %}
                  <i class="fas fa-star"></i>
                  {% else %}
                  <i class="far fa-star"></i>
                  {% endif %} {% endfor %} {% endwith %}
                </div>
                <span class="rating-text">
                  ({{ review_summary.avg_rating|floatformat:1 }}) -
                  {{review_summary.num_reviews }} ØªÙ‚ÙŠÙŠÙ…
                </span>
                {% else %}
                <span class="rating-text">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯</span>
                {% endif %}
              </div>

              <div class="product-price">${{ product.price }}</div>

              <p class="product-description">{{ product.description|safe }}</p>

              {% if product.features %}
              <div class="product-features">
                <h4 style="margin-bottom: 20px; color: var(--clr-ink)">
                  Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
                </h4>

                <!-- Ø­Ù„Ù‚Ø© Ù„Ø¹Ø±Ø¶ ÙƒÙ„ Ù…ÙŠØ²Ø© Ù…Ù† Ø­Ù‚Ù„ JSON -->
                {% for feature in product.features %}
                <div class="feature-item">
                  <!-- ÙŠØ¹Ø±Ø¶ Ø£ÙŠÙ‚ÙˆÙ†Ø© FontAwesome Ù…Ù† Ø§Ù„Ø­Ù‚Ù„ -->
                  <i class="{{ feature.icon }}"></i>
                  <!-- ÙŠØ¹Ø±Ø¶ Ù†Øµ Ø§Ù„Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„Ø­Ù‚Ù„ -->
                  <span>{{ feature.text }}</span>
                </div>
                {% endfor %}
              </div>
              {% endif %}

              <!-- Ù…Ø­Ø¯Ø¯ Ø§Ù„ÙƒÙ…ÙŠØ© -->
              <div class="quantity-selector">
                <span class="quantity-label">Ø§Ù„ÙƒÙ…ÙŠØ©:</span>
                <div class="quantity-controls">
                  <button
                    type="button"
                    class="quantity-btn minus"
                    onclick="changeQuantity(-1)"
                  >
                    -
                  </button>
                  <!-- Ø£Ø¶ÙÙ†Ø§ id="quantity-input" -->
                  <input
                    id="quantity-input"
                    type="text"
                    class="quantity-input"
                    value="1"
                    min="1"
                    readonly
                  />
                  <button
                    type="button"
                    class="quantity-btn plus"
                    onclick="changeQuantity(1)"
                  >
                    +
                  </button>
                </div>
              </div>

              <!-- Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© -->
              <div class="action-buttons">
                <button
                  class="btn-add-cart add-to-cart py-4"
                  data-product-id="{{ product.id }}"
                >
                  <div class="button-wrapper">
                    <span class="text">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</span>
                    <div class="icon">
                      <i class="bi bi-cart-plus fa-lg"></i>
                    </div>
                  </div>
                </button>
              </div>

              <div class="product-meta">
                <div class="meta-item">
                  <span class="meta-label">Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬:</span>
                  <span class="meta-value">{{ product.sku }}</span>
                </div>
                <div class="meta-item">
                  <span class="meta-label">Ø§Ù„ÙØ¦Ø©:</span>
                  <span class="meta-value">{{ product.category.name }}</span>
                </div>
                <div class="meta-item">
                  <span class="meta-label">Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©:</span>
                  <span class="meta-value">{{ product.brand.name }}</span>
                </div>
                <div class="meta-item">
                  <span class="meta-label">Ø­Ø§Ù„Ø© Ø§Ù„ØªÙˆÙØ±:</span>
                  {% if product.is_available %}
                  <span class="meta-value" style="color: var(--clr-primary)"
                    >Ù…ØªÙˆÙØ± ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†</span
                  >
                  {% else %}
                  <span class="meta-value" style="color: red"
                    >ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠÙ‹Ø§</span
                  >
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>

        {% comment %} ØªÙ†Ø¨ÙŠÙ‡Ø§Øª {% endcomment %}
        <div
          id="alert-container"
          class="container"
          style="
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            width: auto;
          "
        ></div>

        <!-- Top centered pill tabs -->
        <div class="d-flex justify-content-center mb-2">
          <ul class="nav tabs-pill mt-5" role="tablist">
            {% comment %}
            <li class="nav-item" role="presentation">
              <button
                class="nav-link active"
                id="tab-description"
                data-bs-toggle="tab"
                data-bs-target="#description"
                type="button"
                role="tab"
                aria-controls="description"
                aria-selected="true"
              >
                Ø§Ù„ÙˆØµÙ
              </button>
            </li>
            {% endcomment %}
            <li class="nav-item" role="presentation">
              <button
                class="nav-link active"
                id="tab-specifications"
                data-bs-toggle="tab"
                data-bs-target="#specifications"
                type="button"
                role="tab"
                aria-controls="specifications"
                aria-selected="false"
              >
                Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button
                class="nav-link"
                id="tab-reviews"
                data-bs-toggle="tab"
                data-bs-target="#reviews"
                type="button"
                role="tab"
                aria-controls="reviews"
                aria-selected="false"
              >
                Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
              </button>
            </li>
            {% comment %}
            <li class="nav-item" role="presentation">
              <button
                class="nav-link"
                id="tab-shipping"
                data-bs-toggle="tab"
                data-bs-target="#shipping"
                type="button"
                role="tab"
                aria-controls="shipping"
                aria-selected="false"
              >
                Ø§Ù„Ø´Ø­Ù†
              </button>
            </li>
            {% endcomment %}
          </ul>
        </div>
        <div class="tab-content px-3" id="productTabsContent">
          {% comment %}
          <div class="tab-pane fade" id="description" role="tabpanel">
            <h4>ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬</h4>
            <p>
              Ù„ÙˆØ­Ø© Arduino UNO R3 Ù‡ÙŠ Ø£ÙØ¶Ù„ Ø®ÙŠØ§Ø± Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ† ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª
              ÙˆØ§Ù„Ø¨Ø±Ù…Ø¬Ø©. ØªØªÙ…ÙŠØ² Ø¨Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§Ù„ØªÙˆØ§ÙÙ‚ Ø§Ù„ÙˆØ§Ø³Ø¹ Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
              Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©.
            </p>
            <p>
              ØªØ­ØªÙˆÙŠ Ø§Ù„Ù„ÙˆØ­Ø© Ø¹Ù„Ù‰ Ù…Ø¹Ø§Ù„Ø¬ ATmega328P Ø§Ù„Ù‚ÙˆÙŠ Ø§Ù„Ø°ÙŠ ÙŠÙˆÙØ± Ø£Ø¯Ø§Ø¡Ù‹ Ù…Ù…ØªØ§Ø²Ø§Ù‹
              Ù„Ù…Ø®ØªÙ„Ù Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹. ÙƒÙ…Ø§ ØªØªØ¶Ù…Ù† 14 Ù…Ù†ÙØ°Ø§Ù‹ Ø±Ù‚Ù…ÙŠØ§Ù‹ Ùˆ6 Ù…Ù†Ø§ÙØ° ØªÙ†Ø§Ø¸Ø±ÙŠØ©ØŒ Ù…Ù…Ø§
              ÙŠØªÙŠØ­ Ù„Ùƒ ØªÙˆØµÙŠÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© ÙˆØ§Ø³Ø¹Ø© Ù…Ù† Ø§Ù„Ø­Ø³Ø§Ø³Ø§Øª ÙˆØ§Ù„Ù…Ø­Ø±ÙƒØ§Øª.
            </p>
            <h5>Ù…Ø§ ÙŠÙ…ÙŠØ² Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬:</h5>
            <ul>
              <li>Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Arduino IDE</li>
              <li>Ù…Ø¬ØªÙ…Ø¹ ÙƒØ¨ÙŠØ± Ù…Ù† Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ† ÙˆØ§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</li>
              <li>ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø¢Ù„Ø§Ù Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©</li>
              <li>Ø¬ÙˆØ¯Ø© ØªØµÙ†ÙŠØ¹ Ø¹Ø§Ù„ÙŠØ© ÙˆØ¶Ù…Ø§Ù† Ù„Ù…Ø¯Ø© Ø³Ù†Ø©</li>
              <li>Ø¯Ù„ÙŠÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø´Ø§Ù…Ù„ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</li>
            </ul>
          </div>
          {% endcomment %}
          <div
            class="tab-pane fade show active"
            id="specifications"
            role="tabpanel"
          >
            <h4>Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ©</h4>
            {% if product.specifications.all %}
            <table class="specifications-table">
              <tbody>
                {% for spec in product.specifications.all %}
                <tr>
                  <!-- Ù†Ø¹Ø±Ø¶ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ§ØµÙØ© -->
                  <th>{{ spec.name }}</th>
                  <!-- Ù†Ø¹Ø±Ø¶ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…ÙˆØ§ØµÙØ© -->
                  <td>{{ spec.value }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
            <!-- Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªØ¸Ù‡Ø± Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ù…ÙˆØ§ØµÙØ§Øª Ù„Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§ØµÙØ§Øª ÙÙ†ÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ø­Ø§Ù„ÙŠÙ‹Ø§.</p>
            {% endif %}
          </div>
          <div class="tab-pane fade" id="reviews" role="tabpanel">
            <h4>ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h4>

            <div class="review-summary mb-4">
              <div class="row">
                <div class="d-flex align-items-center mb-2">
                  <span class="me-2">4 Ù†Ø¬ÙˆÙ…</span>
                  <div class="progress flex-grow-1 me-2" style="height: 8px">
                    <div
                      class="progress-bar bg-warning"
                      style="width: 20%"
                    ></div>
                  </div>
                  <span>5</span>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <span class="me-2">3 Ù†Ø¬ÙˆÙ…</span>
                  <div class="progress flex-grow-1 me-2" style="height: 8px">
                    <div
                      class="progress-bar bg-warning"
                      style="width: 8%"
                    ></div>
                  </div>
                  <span>2</span>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <span class="me-2">2 Ù†Ø¬ÙˆÙ…</span>
                  <div class="progress flex-grow-1 me-2" style="height: 8px">
                    <div
                      class="progress-bar bg-warning"
                      style="width: 0%"
                    ></div>
                  </div>
                  <span>0</span>
                </div>
                <div class="d-flex align-items-center">
                  <span class="me-2">1 Ù†Ø¬Ù…Ø©</span>
                  <div class="progress flex-grow-1 me-2" style="height: 8px">
                    <div
                      class="progress-bar bg-warning"
                      style="width: 0%"
                    ></div>
                  </div>
                  <span>0</span>
                </div>
              </div>

              <!-- Ø¹ÙŠÙ†Ø© Ù…Ù† Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª -->
              {% for review in reviews %}
              <div class="review-item border-bottom pb-3 mb-3 mt-4">
                <div
                  class="d-flex justify-content-between align-items-start mb-2"
                >
                  <div>
                    <!-- Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø°ÙŠ ÙƒØªØ¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…. Ù†Ø¶Ø¹ Ù‚ÙŠÙ…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© "Ø¹Ù…ÙŠÙ„" Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø§Ø³Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ -->
                    <strong>{{ review.customer.name|default:"Ø¹Ù…ÙŠÙ„" }}</strong>
                    <div class="rating-stars">
                      <!-- Ø­Ù„Ù‚Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø¬ÙˆÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ… Ù‡Ø°Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ¯ -->
                      {% for i in "12345" %} {% if i|add:"0" <= review.rating %}
                      <i class="fas fa-star"></i>
                      {% else %}
                      <i class="far fa-star"></i>
                      {% endif %} {% endfor %}
                    </div>
                  </div>
                  <!-- ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù…Ù†Ø³Ù‚Ù‹Ø§ -->
                  <small class="text-muted"
                    >{{ review.review_date|date:"d M, Y" }}</small
                  >
                </div>
                <!-- Ù†Øµ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ -->
                <p>{{ review.comment }}</p>
              </div>
              {% empty %}
              <!-- Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªØ¸Ù‡Ø± ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‚Ø§Ø¦Ù…Ø© `reviews` ÙØ§Ø±ØºØ© -->
              <div
                id="no-reviews-alert"
                class="alert alert-secondary mt-4"
                role="alert"
              >
                ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠÙ‚ÙŠÙ‘Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬!
              </div>
              {% endfor %}

              <div class="review-actions">
                <button id="openReviewForm" class="review-btn">
                  Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚
                </button>
              </div>
              <div id="reviewForm" class="review-form" aria-hidden="true">
                <div class="form-row">
                  <input
                    id="reviewerName"
                    type="text"
                    placeholder="Ø§Ø³Ù…Ùƒ (Ù…Ø·Ù„ÙˆØ¨)"
                    required
                  />
                  <select id="reviewRating">
                    <option value="5">5 Ù†Ø¬ÙˆÙ…</option>
                    <option value="4">4 Ù†Ø¬ÙˆÙ…</option>
                    <option value="3">3 Ù†Ø¬ÙˆÙ…</option>
                    <option value="2">2 Ù†Ø¬ÙˆÙ…</option>
                    <option value="1">1 Ù†Ø¬Ù…Ø©</option>
                  </select>
                </div>
                <div class="form-row">
                  <textarea
                    id="reviewText"
                    placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§..."
                    required
                  ></textarea>
                </div>
                <div style="text-align: left">
                  <button id="submitReview" class="submit-btn">
                    Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚
                  </button>
                  <button
                    id="cancelReview"
                    class="review-btn"
                    style="background: #f3f3f3; color: #333"
                  >
                    Ø¥Ù„ØºØ§Ø¡
                  </button>
                </div>
              </div>
            </div>
          </div>
          {% comment %} >Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø­Ù† ÙˆØ§Ù„Ø¥Ø±Ø¬Ø§Ø¹ {% endcomment %}
          <div class="tab-pane fade" id="shipping" role="tabpanel">
            <h4>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø­Ù† ÙˆØ§Ù„Ø¥Ø±Ø¬Ø§Ø¹</h4>

            <h5>Ø§Ù„Ø´Ø­Ù†:</h5>
            <ul>
              <li>Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ Ù„Ù„Ø·Ù„Ø¨Ø§Øª ÙÙˆÙ‚ $25</li>
              <li>Ø§Ù„ØªÙˆØµÙŠÙ„ Ø®Ù„Ø§Ù„ 2-3 Ø£ÙŠØ§Ù… Ø¹Ù…Ù„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¯Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</li>
              <li>Ø§Ù„ØªÙˆØµÙŠÙ„ Ø®Ù„Ø§Ù„ 3-5 Ø£ÙŠØ§Ù… Ø¹Ù…Ù„ Ù„Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø£Ø®Ø±Ù‰</li>
              <li>Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØªØ¨Ø¹ Ø§Ù„Ø´Ø­Ù†Ø© Ø¹Ø¨Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹</li>
            </ul>

            <h5>Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹:</h5>
            <ul>
              <li>Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ø®Ù„Ø§Ù„ 30 ÙŠÙˆÙ… Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</li>
              <li>Ø§Ù„Ù…Ù†ØªØ¬ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ÙÙŠ Ø­Ø§Ù„ØªÙ‡ Ø§Ù„Ø£ØµÙ„ÙŠØ©</li>
              <li>Ø§Ø³ØªØ±Ø¯Ø§Ø¯ ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ø¨Ù„Øº ÙÙŠ Ø­Ø§Ù„Ø© Ø¹ÙŠØ¨ Ø§Ù„Ù…Ù†ØªØ¬</li>
              <li>Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø¬Ø§Ù†ÙŠ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ Ù…Ù† Ø¬Ø§Ù†Ø¨Ù†Ø§</li>
            </ul>

            <h5>Ø§Ù„Ø¶Ù…Ø§Ù†:</h5>
            <ul>
              <li>Ø¶Ù…Ø§Ù† Ù„Ù…Ø¯Ø© Ø³Ù†Ø© ÙƒØ§Ù…Ù„Ø© Ø¶Ø¯ Ø¹ÙŠÙˆØ¨ Ø§Ù„ØªØµÙ†ÙŠØ¹</li>
              <li>Ø¯Ø¹Ù… ÙÙ†ÙŠ Ù…Ø¬Ø§Ù†ÙŠ Ø·ÙˆØ§Ù„ ÙØªØ±Ø© Ø§Ù„Ø¶Ù…Ø§Ù†</li>
              <li>Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙÙˆØ±ÙŠ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø¹ÙŠØ¨ Ø®Ù„Ø§Ù„ Ø£ÙˆÙ„ 7 Ø£ÙŠØ§Ù…</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø°Ø§Øª Ø§Ù„ØµÙ„Ø© -->
    {% include "partials/cards3_deta.html" with products=related_products %}

    <script>
      // ==========================================
      // 1. Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± (Thumbnail Gallery)
      // ==========================================
      (function () {
        window.changeMainImage = function (img) {
          const main = document.getElementById("mainImage");
          if (!main || !img) return;
          main.src = img.src;
          document
            .querySelectorAll(".thumbnail")
            .forEach((t) => t.classList.remove("active"));
          img.classList.add("active");
        };

        function scrollThumbnails(delta) {
          const gallery = document.querySelector(".thumbnail-gallery");
          if (!gallery) return;
          if (getComputedStyle(gallery).flexDirection === "column") {
            gallery.scrollBy({ top: delta * 80, behavior: "smooth" });
          } else {
            gallery.scrollBy({ left: delta * 100, behavior: "smooth" });
          }
        }

        document
          .querySelectorAll(".thumb-prev")
          .forEach((btn) =>
            btn.addEventListener("click", () => scrollThumbnails(-1))
          );
        document
          .querySelectorAll(".thumb-next")
          .forEach((btn) =>
            btn.addEventListener("click", () => scrollThumbnails(1))
          );
      })();

      // ==========================================
      // 2. Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙƒÙ…ÙŠØ© (+ Ùˆ -)
      // ==========================================
      function changeQuantity(amount) {
        const quantityInput = document.getElementById("quantity-input");
        let currentQuantity = parseInt(quantityInput.value) || 1;
        let newQuantity = currentQuantity + amount;

        if (newQuantity < 1) newQuantity = 1;
        quantityInput.value = newQuantity;
      }

      // ==========================================
      // 3. Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª (Reviews) - Ù…Ø·ÙˆØ± Ø¨Ù€ SweetAlert
      // ==========================================
      document.addEventListener("DOMContentLoaded", function () {
        const openBtn = document.getElementById("openReviewForm");
        const form = document.getElementById("reviewForm");
        const cancelBtn = document.getElementById("cancelReview");
        const submitBtn = document.getElementById("submitReview");

        // ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        if (openBtn) {
          openBtn.addEventListener("click", () => {
            form.style.display =
              form.style.display === "block" ? "none" : "block";
          });
        }

        if (cancelBtn) {
          cancelBtn.addEventListener("click", (e) => {
            e.preventDefault();
            form.style.display = "none";
          });
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
        if (submitBtn) {
          submitBtn.addEventListener("click", (e) => {
            e.preventDefault();

            const rating = document.getElementById("reviewRating").value;
            const comment = document.getElementById("reviewText").value.trim();
            const name = document.getElementById("reviewerName").value.trim();

            // Ù†Ø£Ø®Ø° ID Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ØµÙØ­Ø©
            const addToCartBtn = document.querySelector(".add-to-cart");
            const productId = addToCartBtn
              ? addToCartBtn.dataset.productId
              : null;

            if (!productId) {
              Swal.fire({
                icon: "error",
                title: "Ø®Ø·Ø£",
                text: "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù†ØªØ¬",
              });
              return;
            }

            if (!name || !comment) {
              Swal.fire({
                icon: "warning",
                title: "ØªÙ†Ø¨ÙŠÙ‡",
                text: "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ ÙˆØ§Ù„ØªØ¹Ù„ÙŠÙ‚",
              });
              return;
            }

            // ØªØºÙŠÙŠØ± Ø§Ù„Ø²Ø±
            const originalText = submitBtn.textContent;
            submitBtn.textContent = "Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";
            submitBtn.disabled = true;

            // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
            fetch(`/add-review/${productId}/`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": getCookie("csrftoken"), // Ø¯Ø§Ù„Ø© getCookie Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ base.html
              },
              body: JSON.stringify({
                rating: rating,
                comment: comment,
                name: name,
              }),
            })
              .then((response) => response.json())
              .then((data) => {
                if (data.status === "success") {
                  // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
                  form.style.display = "none";
                  document.getElementById("reviewText").value = "";

                  Swal.fire({
                    icon: "success",
                    title: "Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ!",
                    text: data.message,
                    timer: 2000,
                    showConfirmButton: false,
                  }).then(() => {
                    window.location.reload(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© Ù„Ø±Ø¤ÙŠØ© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯
                  });
                } else {
                  Swal.fire({
                    icon: "error",
                    title: "Ø®Ø·Ø£",
                    text: data.message,
                  });
                }
              })
              .catch((error) => {
                console.error("Error:", error);
                Swal.fire({
                  icon: "error",
                  title: "Ø®Ø·Ø£",
                  text: "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…",
                });
              })
              .finally(() => {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
              });
          });
        }
      });
    </script>
  </body>
</html>
{% endblock %}
